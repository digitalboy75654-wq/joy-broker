<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Joy Broker | Home</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}
body{
  background:radial-gradient(circle,#111,#000);
  color:#fff;
  min-height:100vh;
}

/* HEADER */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px;
  background:#050505;
  box-shadow:0 0 20px rgba(255,215,0,.3);
}
.logo{color:gold;font-size:20px;font-weight:600}
.wallet{
  background:#111;
  padding:8px 16px;
  border-radius:20px;
  color:gold;
  font-weight:600;
  border: 1px solid gold;
}

/* USER INFO BAR */
.user-info-bar {
    background: rgba(255, 215, 0, 0.1);
    padding: 10px 20px;
    font-size: 12px;
    display: flex;
    justify-content: space-between;
    border-bottom: 1px solid rgba(255, 215, 0, 0.2);
}
.user-info-bar span { color: #ccc; }
.user-info-bar b { color: gold; }

/* ACTIONS & BUTTONS */
.actions{
  display:flex;
  justify-content:space-around;
  margin:20px;
  gap: 10px;
}
.actions button {
  flex:1;
  padding:14px;
  border:none;
  border-radius:14px;
  background:linear-gradient(135deg,#ffd700,#b8860b);
  font-weight:600;
  cursor:pointer;
  font-size: 13px;
  transition: 0.3s;
}
.actions button:active { transform: scale(0.9); }

/* GAMES SECTION */
.games{margin:20px}
.games h2{text-align:center;color:gold;margin-bottom:15px}
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
}
.card{
  background:#111;
  border-radius:18px;
  padding:20px;
  text-align:center;
  cursor:pointer;
  box-shadow:0 0 20px rgba(255,215,0,.2);
  transition:.3s;
}
.card:hover{
  transform:translateY(-6px);
  box-shadow:0 0 30px rgba(255,215,0,.5);
}
.icon{font-size:40px; margin-bottom: 5px;}

/* BOTTOM NAV (Support & Logout) */
.bottom-nav {
    position: fixed;
    bottom: 20px;
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 20px;
}
.nav-btn {
    background: #222;
    color: white;
    padding: 10px 20px;
    border-radius: 30px;
    border: 1px solid gold;
    font-size: 14px;
    cursor: pointer;
    font-weight: 600;
}
.logout-btn { border-color: #ff4d4d; color: #ff4d4d; }

@media(max-width:600px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<div class="header">
  <div class="logo">Joy Broker</div>
  <div class="wallet">Balance: $<span id="balance">0.00</span></div>
</div>

<div class="user-info-bar">
    <span>User: <b id="display-name">Loading...</b></span>
    <span>ID: <b id="display-id">...</b></span>
</div>

<div class="actions">
  <button onclick="go('deposit.html')">ðŸ’µ Deposit</button>
  <button onclick="go('withdraw.html')">ðŸ’¸ Withdraw</button>
  <button onclick="go('referral.html')">ðŸ‘¥ Earn $5</button>
</div>

<div class="games">
  <h2>Select Game</h2>
  <div class="grid">
    <div class="card" onclick="go('spinner.html')">
      <div class="icon">ðŸŽ¡</div>Spinner
    </div>
    <div class="card" onclick="go('dice.html')">
      <div class="icon">ðŸŽ²</div>Dice Roll
    </div>
    <div class="card" onclick="go('investing.html')">
      <div class="icon">ðŸ’°</div>Invest In AI Daily Profit 3%
    </div>
  </div>
</div>
  <div style="margin: 25px; padding: 20px; background: rgba(255, 215, 0, 0.05); border-radius: 15px; border: 1px dashed rgba(255, 215, 0, 0.3);">
    <h4 style="color: gold; margin-bottom: 10px; font-size: 14px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸ¤–</span> How Our AI Investment Works
    </h4>
    <p style="color: #ccc; font-size: 12px; line-height: 1.6; text-align: justify;">
        When you participate in our <b style="color: gold;">Daily Earn 3%</b> program, your invested capital is managed by our advanced 
        <b>AI Trading Algorithms</b>. Our AI utilizes these funds to perform high-frequency trading in global markets and 
        real-time asset flipping to generate consistent returns. 
        <br><br>
        Out of the total profits generated, <b>Joy Broker</b> distributes a fixed <b>3% daily commission</b> directly back to the investor. 
        This ensures a steady passive income stream for you while our technology handles the complexity of the market.
    </p>
</div>

<div class="bottom-nav">
    <style>
    .support-container {
        position: fixed; /* Aap ise 'relative' bhi kar sakte hain agar list mein rakhna ho */
        bottom: 20px;
        right: 20px;
        z-index: 9999;
    }

    .btn-support-modern {
        background: linear-gradient(135deg, #ffd700 0%, #b8860b 100%);
        color: #000;
        border: none;
        padding: 12px 22px;
        font-size: 14px;
        font-weight: bold;
        border-radius: 50px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .btn-support-modern:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
    }

    /* Notification Badge */
    #supportBadge {
        display: none; /* Default hidden */
        position: absolute;
        top: -8px;
        right: -2px;
        background: #ff0000;
        color: white;
        border: 2px solid #fff;
        border-radius: 50%;
        min-width: 22px;
        height: 22px;
        font-size: 11px;
        font-weight: bold;
        text-align: center;
        line-height: 18px;
        box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        animation: badge-pulse 1.5s infinite;
    }

    @keyframes badge-pulse {
        0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); }
        70% { transform: scale(1.2); box-shadow: 0 0 0 10px rgba(255, 0, 0, 0); }
        100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); }
    }
</style>

<div class="support-container">
    <span id="supportBadge">0</span>
    <button onclick="window.location.href='chat.html'" class="btn-support-modern">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
        </svg>
        Support
    </button>
</div>

<script>
    // Ensure Firebase is initialized before this
    firebase.auth().onAuthStateChanged(user => {
        if (user) {
            const badge = document.getElementById('supportBadge');
            const uid = user.uid;

            // Listen to unread messages from Admin
            firebase.database().ref('notifications/' + uid + '/unread').on('value', snap => {
                const unreadCount = snap.val() || 0;
                
                if (unreadCount > 0) {
                    badge.innerText = unreadCount;
                    badge.style.display = 'block';
                } else {
                    badge.style.display = 'none';
                }
            });
        }
    });
</script>
    
</div>

<script>
// --- Firebase Config ---
const firebaseConfig = {
    apiKey: "AIzaSyDz_mp5wpULG732DXhZDoVczdy369j8WBY",
    authDomain: "ludo-joy-fb32d.firebaseapp.com",
    databaseURL: "https://ludo-joy-fb32d-default-rtdb.firebaseio.com",
    projectId: "ludo-joy-fb32d",
    storageBucket: "ludo-joy-fb32d.firebasestorage.app",
    messagingSenderId: "128560388256",
    appId: "1:128560388256:web:a8b945a3658160277391c5"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// --- Live Sync with Realtime Database ---
auth.onAuthStateChanged(user => {
    if (user) {
        // UID display (First 8 characters)
        document.getElementById("display-id").innerText = user.uid.substring(0, 8);
        
        // Database se asli data fetch karein
        db.ref('users/' + user.uid).on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                // Wallet balance sync
                document.getElementById("balance").innerText = Number(data.wallet || 0).toFixed(2);
                // Username sync
                document.getElementById("display-name").innerText = data.username || "User";
            }
        });
    } else {
        window.location.href = "index.html";
    }
});

// --- Actions ---
function go(page){
  window.location.href = page;
}

function logout() {
    auth.signOut().then(() => {
        window.location.href = "index.html";
    });
}

function openSupport() {
    // Ab ye seedha chat.html par le jayega jahan user message bhej sake
    window.location.href = "chat.html"; 
}
</script>

</body>

</html>


